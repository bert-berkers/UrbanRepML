# Del Norte County Active Inference Experiment Configuration
# Integrating AlphaEarth embeddings with information-theoretic spatial learning

experiment:
  name: del_norte_active_inference
  type: spatial_representation_learning
  framework: active_inference
  purpose: information_theoretic_analysis
  created: 2025-01-15
  author: UrbanRepML
  
region:
  name: Del Norte County
  state: California
  fips: "06015"
  
  # Geographic bounds
  bounds:
    north: 42.0
    south: 41.5
    west: -124.4
    east: -123.8
  
  # Area statistics
  area_km2: 3180
  population: 27743
  agricultural_focus: ["dairy", "lily_bulbs", "forestry", "cranberries"]
  
# AlphaEarth Data Configuration
alphaearth:
  source_dir: "G:/My Drive/AlphaEarth_Cascadia"  # Google Drive location
  years: [2020, 2021, 2022, 2023]
  resolution_meters: 10
  bands: 64  # Embedding dimensions A00-A63
  file_format: GeoTIFF
  
# Active Inference Configuration
active_inference:
  # Free Energy Parameters
  free_energy:
    complexity_weight: 0.5  # Weight for KL divergence term
    accuracy_weight: 0.5    # Weight for log-likelihood term
    precision_init: 1.0     # Initial precision parameter
    learning_rate: 0.001    # Free energy gradient descent rate
    
  # Belief Updating
  belief_updating:
    method: variational_message_passing  # or gradient_descent
    max_iterations: 100
    convergence_threshold: 1e-4
    damping_factor: 0.5  # For message passing stability
    
  # Hierarchical Structure
  hierarchy:
    levels: [5, 6, 7, 8, 9, 10, 11]  # H3 resolutions
    primary_level: 8  # Main resolution for analysis
    parent_child_influence: 0.3  # Hierarchical coupling strength
    
  # Markov Blankets
  markov_blankets:
    spatial_radius: 2  # H3 cells for spatial context
    temporal_window: 1  # Years for temporal context
    include_diagonal: true  # Include diagonal neighbors
    
  # Expected Free Energy (for gap detection/actualization)
  expected_free_energy:
    epistemic_weight: 0.6  # Information gain priority
    pragmatic_weight: 0.4  # Goal achievement priority
    exploration_bonus: 0.1  # Encourage exploring uncertain areas
    planning_horizon: 3  # Time steps ahead for planning
    
# Information Theory Metrics
information_metrics:
  # Entropy Calculations
  entropy:
    method: histogram  # histogram, kde, or knn
    normalize: true
    bin_strategy: auto  # auto, fixed, or adaptive
    n_bins: 50  # For histogram-based entropy
    
  # Mutual Information
  mutual_information:
    method: kraskov  # k-nearest neighbors estimator
    k_neighbors: 3
    normalize_mi: true  # Normalized MI in [0, 1]
    
  # Information Gain
  information_gain:
    baseline: prior  # Compare against prior or uniform
    cumulative: true  # Track cumulative gain
    per_dimension: true  # Calculate per embedding dimension
    
  # Divergence Measures
  divergence:
    kl_divergence: true
    js_divergence: true  # Jensen-Shannon divergence
    wasserstein_distance: false  # Computational cost
    
# H3 Processing Configuration
h3_processing:
  resolutions: [7, 8, 9, 10]  # Focus on agricultural-relevant scales
  aggregation:
    method: information_weighted_mean  # Weight by information content
    min_pixels_per_hex: 10
    uncertainty_threshold: 0.8  # Max acceptable uncertainty
    
  # Information-aware aggregation
  info_aggregation:
    use_entropy_weighting: true
    preserve_high_info_cells: true
    smooth_transitions: true
    
# Spatial Representation Learning
representation_learning:
  # Embedding Configuration
  embedding:
    input_dim: 64  # AlphaEarth dimensions
    hidden_dims: [128, 64, 32]  # Encoder architecture
    latent_dim: 16  # Compressed representation
    
  # Loss Functions
  loss:
    reconstruction_weight: 0.3
    free_energy_weight: 0.4
    information_gain_weight: 0.3
    spatial_consistency_weight: 0.2
    temporal_consistency_weight: 0.1
    
  # Training Configuration
  training:
    epochs: 200
    batch_size: 64
    learning_rate: 0.001
    optimizer: adam
    scheduler: cosine_annealing
    early_stopping_patience: 20
    
# Gap Detection and Actualization
actualization:
  # Gap Detection
  gap_detection:
    method: expected_free_energy  # Use EFE to identify gaps
    spatial_coverage_threshold: 0.7
    temporal_coverage_threshold: 0.5
    information_threshold: 0.3  # Min information content
    
  # Synthetic Generation
  generation:
    method: variational_autoencoder
    use_active_inference: true  # Guide generation with free energy
    latent_prior: gaussian
    beta_vae_weight: 0.01  # Disentanglement
    
  # Validation
  validation:
    withhold_percent: 0.2  # Test data percentage
    spatial_holdout: true  # Hold out spatial regions
    temporal_holdout: false  # Keep all years for Del Norte
    metrics: [mse, free_energy, information_gain, spatial_coherence]
    
# Output Configuration
output:
  # File Organization
  structure:
    by_year: true
    by_resolution: true
    by_metric: true
    
  # Naming Convention
  naming:
    pattern: "del_norte_{year}_h3_res{resolution}_{metric}.parquet"
    include_timestamp: false
    
  # Visualizations
  visualizations:
    free_energy_landscape: true
    information_gain_map: true
    belief_evolution: true
    uncertainty_heatmap: true
    markov_blanket_graph: true
    
  # Reports
  reports:
    generate_summary: true
    include_theory_validation: true
    save_intermediate_states: true
    checkpoint_frequency: 10  # epochs
    
# Computational Resources
resources:
  device: cuda  # or cpu
  mixed_precision: true
  num_workers: 4
  pin_memory: true
  
  # Memory Management
  memory:
    max_batch_size: 128
    gradient_accumulation: 2
    cache_embeddings: true
    
# Logging Configuration
logging:
  level: INFO
  wandb:
    enabled: false
    project: del_norte_active_inference
    tags: ["alphaearth", "active_inference", "information_theory"]
  tensorboard:
    enabled: true
    log_dir: logs/tensorboard
  
# GEO-INFER Alignment
geoinfer:
  export_format: parquet
  include_uncertainty: true
  include_free_energy: true
  include_information_metrics: true
  coordinate_system: EPSG:4326
  metadata:
    include_county_id: true
    include_agricultural_zones: true
    include_timestamps: true