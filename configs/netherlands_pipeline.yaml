# Netherlands Multi-Modal Urban Embedding Pipeline Configuration

study_area:
  name: netherlands
  h3_resolution: 10
  boundary_file: data/study_areas/netherlands/area_gdf/netherlands_boundary.geojson
  description: "Netherlands multi-modal urban analysis at H3 resolution 10"

modalities:
  alphaearth:
    enabled: true
    source: data/study_areas/netherlands/embeddings/alphaearth/alphaearth_embeddings_res10.parquet
    features: 64
    preprocessing:
      normalize: true
      pca_components: 16
    weight: 1.0

  poi:
    enabled: true
    source: data/study_areas/netherlands/embeddings/poi/poi_embeddings_res10.parquet
    features: 28
    feature_groups:
      counts: ["amenity_*", "shop_*", "leisure_*", "tourism_*", "office_*"]
      diversity: ["poi_shannon_entropy", "poi_simpson_diversity", "poi_richness", "poi_evenness"]
      embeddings: ["hex2vec_*", "geovex_*"]
    preprocessing:
      normalize: true
      scale_diversity: false
    weight: 1.0

  roads:
    enabled: true
    source: data/study_areas/netherlands/embeddings/roads/roads_embeddings_res10.parquet
    features: 30
    preprocessing:
      normalize: true
    weight: 1.0

feature_processing:
  pca:
    variance_threshold: 0.95
    min_components:
      alphaearth: 16
      poi: 10
      roads: 10
    max_components: 50
  normalization:
    method: "standard"
    per_modality: true
  fusion:
    method: "concatenate"
    normalize_weights: true

graph:
  type: "hexagonal"
  hexagonal:
    neighbor_rings: 2
    edge_weight: 1.0
    include_self_loops: false
  accessibility:
    modes: ["walk", "bike", "drive"]
    speeds:
      walk: 5.0
      bike: 15.0
      drive: 50.0
    max_travel_time:
      walk: 15
      bike: 15
      drive: 15
    search_radius:
      walk: 2000
      bike: 5000
      drive: 15000
    beta:
      walk: 0.1
      bike: 0.05
      drive: 0.01

model:
  architecture: "FullAreaUNet"
  hidden_dim: 256
  num_layers: 3
  dropout: 0.1
  activation: "relu"
  training:
    batch_size: 32
    learning_rate: 0.001
    epochs: 100
    early_stopping_patience: 10
    validation_split: 0.2
  loss:
    reconstruction_weight: 1.0
    contrastive_weight: 0.1
    spatial_weight: 0.1

output:
  base_dir: data/study_areas/netherlands/stage2_fusion/results [old 2024]
  save_intermediate: true
  intermediate_dir: data/study_areas/netherlands/stage2_fusion/intermediate
  save:
    embeddings: true
    reconstructions: true
    attention_maps: true
    cluster_assignments: true
  visualization:
    generate_maps: true
    cmap: "viridis"
    dpi: 150
    figsize: [12, 10]

clustering:
  method: "kmeans"
  n_clusters: [5, 10, 15, 20]
  metric: "euclidean"
  hierarchical:
    enabled: true
    linkage: "ward"
    distance_threshold: null

evaluation:
  metrics:
    - silhouette_score
    - davies_bouldin_score
    - calinski_harabasz_score
    - reconstruction_error
  spatial:
    - moran_i
    - geary_c

logging:
  level: INFO
  log_file: logs/netherlands_pipeline.log

monitoring:
  use_wandb: false
  wandb_project: "urban-rep-ml"
  wandb_entity: null
  track:
    - loss
    - reconstruction_error
    - clustering_metrics
    - memory_usage
    - processing_time
